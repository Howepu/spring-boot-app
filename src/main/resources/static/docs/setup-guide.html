<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Руководство по установке - Spring Boot Ollama Integration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/doc-styles.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Боковая навигация -->
            <div class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <h5 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>Руководство по установке</span>
                    </h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">
                                Вернуться на главную
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#prerequisites">
                                Требования
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#installation">
                                Установка
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#configuration">
                                Настройка
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#ollama-setup">
                                Настройка Ollama
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#launching">
                                Запуск приложения
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#deployment">
                                Варианты развертывания
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Основной контент -->
            <div class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1>Руководство по установке и настройке</h1>
                </div>

                <section id="prerequisites">
                    <h2>Требования</h2>
                    <p>Для работы с приложением необходимо установить следующие компоненты:</p>
                    
                    <h4>Обязательные компоненты:</h4>
                    <ul>
                        <li><strong>Java 17+</strong> - для запуска Spring Boot приложения</li>
                        <li><strong>PostgreSQL 14+</strong> - база данных для хранения инсайтов</li>
                        <li><strong>Ollama</strong> - локальный API для запуска моделей нейросети</li>
                    </ul>
                    
                    <h4>Дополнительные компоненты (для мониторинга):</h4>
                    <ul>
                        <li><strong>Prometheus</strong> - система для сбора метрик</li>
                        <li><strong>Grafana</strong> - платформа для визуализации метрик</li>
                    </ul>
                    
                    <h4>Рекомендуемые системные требования:</h4>
                    <ul>
                        <li>CPU: 4+ ядер</li>
                        <li>RAM: минимум 8 ГБ (16+ ГБ рекомендуется для запуска больших моделей в Ollama)</li>
                        <li>Диск: 2+ ГБ для приложения, 10+ ГБ для Ollama моделей</li>
                    </ul>
                </section>

                <section id="installation" class="mt-5">
                    <h2>Установка</h2>
                    
                    <h3>1. Клонирование репозитория</h3>
                    <pre><code>git clone https://github.com/your-username/spring-boot-ollama-integration.git
cd spring-boot-ollama-integration</code></pre>
                    
                    <h3>2. Установка Java 17</h3>
                    <p>Если Java 17 не установлена на вашей системе, установите её:</p>
                    
                    <h4>Linux (Ubuntu/Debian):</h4>
                    <pre><code>sudo apt update
sudo apt install openjdk-17-jdk</code></pre>
                    
                    <h4>Windows:</h4>
                    <p>Скачайте и установите Java 17 с <a href="https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html" target="_blank">официального сайта Oracle</a> или используйте <a href="https://adoptium.net/" target="_blank">Eclipse Adoptium</a>.</p>
                    
                    <h3>3. Установка PostgreSQL</h3>
                    
                    <h4>Linux (Ubuntu/Debian):</h4>
                    <pre><code>sudo apt update
sudo apt install postgresql postgresql-contrib</code></pre>
                    
                    <h4>Windows:</h4>
                    <p>Скачайте и установите PostgreSQL с <a href="https://www.postgresql.org/download/windows/" target="_blank">официального сайта</a>.</p>
                    
                    <h4>Создание базы данных:</h4>
                    <pre><code>sudo -u postgres psql
CREATE DATABASE ollama_insights;
CREATE USER ollama_user WITH ENCRYPTED PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE ollama_insights TO ollama_user;
\q</code></pre>
                    
                    <h3>4. Установка Ollama</h3>
                    <p>Следуйте инструкциям на <a href="https://ollama.com/download" target="_blank">официальном сайте Ollama</a> для вашей операционной системы.</p>
                </section>

                <section id="configuration" class="mt-5">
                    <h2>Настройка</h2>
                    
                    <h3>1. Настройка базы данных</h3>
                    <p>Отредактируйте файл <code>src/main/resources/application.yml</code> для настройки подключения к базе данных:</p>
                    <pre><code>spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/ollama_insights
    username: ollama_user
    password: your_password</code></pre>
                    
                    <h3>2. Настройка Ollama API</h3>
                    <p>В том же файле <code>application.yml</code> настройте параметры подключения к Ollama API:</p>
                    <pre><code>ollama:
  api:
    url: http://localhost:11434
  model: llama2:latest</code></pre>
                    <p>Если Ollama API запущен на другом сервере или порту, соответствующим образом измените URL.</p>
                    
                    <h3>3. Настройка безопасности</h3>
                    <p>Для боевого окружения рекомендуется настроить защищенный доступ. Отредактируйте файл <code>src/main/java/com/example/springbootapp/config/SecurityConfig.java</code> и закомментируйте следующие строки для включения базовой аутентификации:</p>
                    <pre><code>@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    http
        .authorizeHttpRequests(authorize -> authorize
            .requestMatchers("/", "/css/**", "/js/**", "/docs/**").permitAll()
            .requestMatchers("/api/**").authenticated()
            .requestMatchers("/admin/**").hasRole("ADMIN")
            .anyRequest().authenticated()
        )
        .formLogin(form -> form
            .loginPage("/login")
            .defaultSuccessUrl("/dashboard")
            .permitAll()
        )
        .logout(logout -> logout
            .logoutSuccessUrl("/")
            .permitAll()
        );
    
    return http.build();
}</code></pre>
                </section>

                <section id="ollama-setup" class="mt-5">
                    <h2>Настройка Ollama</h2>
                    
                    <h3>1. Запуск Ollama сервера</h3>
                    
                    <h4>Linux/macOS:</h4>
                    <pre><code>ollama serve</code></pre>
                    
                    <h4>Windows:</h4>
                    <p>Запустите Ollama из меню Пуск или через командную строку.</p>
                    
                    <h3>2. Загрузка модели</h3>
                    <p>Перед использованием приложения необходимо загрузить нейросетевую модель:</p>
                    <pre><code>ollama pull llama2</code></pre>
                    
                    <p>Для более качественных результатов можно использовать другие модели:</p>
                    <pre><code>ollama pull mistral
ollama pull llama2:13b</code></pre>
                    
                    <h3>3. Проверка работы Ollama</h3>
                    <p>Убедитесь, что Ollama API работает, отправив тестовый запрос:</p>
                    
                    <pre><code>curl -X POST http://localhost:11434/api/generate -d '{
  "model": "llama2",
  "prompt": "Hello, world!"
}'</code></pre>
                </section>

                <section id="launching" class="mt-5">
                    <h2>Запуск приложения</h2>
                    
                    <h3>1. Сборка проекта</h3>
                    <p>В корневой директории проекта выполните:</p>
                    <pre><code>./mvnw clean install -DskipTests</code></pre>
                    
                    <h3>2. Запуск приложения</h3>
                    <pre><code>./mvnw spring-boot:run</code></pre>
                    
                    <p>Или после сборки:</p>
                    <pre><code>java -jar target/spring-boot-app-0.0.1-SNAPSHOT.jar</code></pre>
                    
                    <h3>3. Доступ к приложению</h3>
                    <p>После успешного запуска приложение будет доступно по адресу:</p>
                    <ul>
                        <li>Веб-интерфейс: <a href="http://localhost:8080" target="_blank">http://localhost:8080</a></li>
                        <li>API: <a href="http://localhost:8080/api/insights" target="_blank">http://localhost:8080/api/insights</a></li>
                        <li>Документация: <a href="http://localhost:8080/documentation" target="_blank">http://localhost:8080/documentation</a></li>
                        <li>Метрики: <a href="http://localhost:8080/actuator/prometheus" target="_blank">http://localhost:8080/actuator/prometheus</a></li>
                    </ul>
                </section>

                <section id="deployment" class="mt-5">
                    <h2>Варианты развертывания</h2>
                    
                    <h3>1. Docker</h3>
                    <p>Для упрощения развертывания можно использовать Docker:</p>
                    
                    <h4>Сборка Docker образа:</h4>
                    <pre><code>docker build -t spring-boot-ollama-integration .</code></pre>
                    
                    <h4>Запуск в Docker:</h4>
                    <pre><code>docker run -p 8080:8080 \
  --name spring-boot-ollama \
  -e SPRING_DATASOURCE_URL=jdbc:postgresql://host.docker.internal:5432/ollama_insights \
  -e SPRING_DATASOURCE_USERNAME=ollama_user \
  -e SPRING_DATASOURCE_PASSWORD=your_password \
  -e OLLAMA_API_URL=http://host.docker.internal:11434 \
  spring-boot-ollama-integration</code></pre>
                    
                    <h3>2. Docker Compose</h3>
                    <p>Для запуска всего стека (приложение, PostgreSQL, Prometheus) можно использовать Docker Compose:</p>
                    <pre><code>version: '3.8'

services:
  app:
    build: .
    ports:
      - "8080:8080"
    depends_on:
      - postgres
    environment:
      - SPRING_DATASOURCE_URL=jdbc:postgresql://postgres:5432/ollama_insights
      - SPRING_DATASOURCE_USERNAME=ollama_user
      - SPRING_DATASOURCE_PASSWORD=your_password
      - OLLAMA_API_URL=http://host.docker.internal:11434

  postgres:
    image: postgres:14
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_DB=ollama_insights
      - POSTGRES_USER=ollama_user
      - POSTGRES_PASSWORD=your_password
    volumes:
      - postgres_data:/var/lib/postgresql/data

  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'

volumes:
  postgres_data:</code></pre>
                    
                    <h3>3. Развертывание на сервере</h3>
                    <p>Для развертывания на production сервере:</p>
                    <ul>
                        <li>Настройте HTTPS через прокси-сервер (например, Nginx)</li>
                        <li>Настройте базу данных PostgreSQL с более строгими параметрами безопасности</li>
                        <li>Используйте systemd для управления процессом Java-приложения</li>
                        <li>Настройте логирование в файл или централизованную систему логирования</li>
                    </ul>
                    
                    <h4>Пример systemd сервиса:</h4>
                    <pre><code>[Unit]
Description=Spring Boot Ollama Integration
After=syslog.target network.target

[Service]
User=spring
Group=spring
WorkingDirectory=/opt/spring-boot-ollama
ExecStart=/usr/bin/java -jar spring-boot-app.jar
SuccessExitStatus=143
TimeoutStopSec=10
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target</code></pre>
                </section>

                <footer class="mt-5 pt-3 border-top">
                    <p class="text-muted">&copy; 2025 Spring Boot Ollama Integration</p>
                </footer>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/docs.js"></script>
</body>
</html>
